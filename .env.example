# =============================================================================
# Exemplo de Configuração do Zabbix Proxy para Alta Carga (15k+ itens)
# =============================================================================
# Copie este arquivo para .env e ajuste os valores conforme necessário

# Configurações básicas do proxy
ZBX_HOSTNAME=corewise-proxy
ZBX_SERVER_HOST=SEU_SERVIDOR_ZABBIX_IP
ZBX_SERVER_PORT=10051

# Configurações de timeout e conexão
ZBX_TIMEOUT=30
ZBX_UNREACHABLE_DELAY=60
ZBX_UNAVAILABLE_DELAY=300

# Configurações de buffer para alta carga com 300GB+ disponível
# Para 15k+ itens com muito espaço em disco
ZBX_LOCAL_BUFFER=8760    # 1 ano de dados (365 dias)
ZBX_OFFLINE_BUFFER=17520 # 2 anos de dados offline (730 dias)

# Configurações de cache otimizadas para 15k itens (Zabbix Proxy 7.0)
# Ajuste conforme a memória disponível
ZBX_HISTORY_CACHE_SIZE=256M     # Cache para dados históricos
ZBX_HISTORY_INDEX_CACHE_SIZE=64M # Cache para índices
# NOTA: TrendCacheSize não é suportado no Zabbix Proxy 7.0

# Configurações de processos para alta carga
# Ajuste conforme CPU disponível
ZBX_START_POLLERS=50        # Coletores principais
ZBX_START_IPMI_POLLERS=5    # Coletores IPMI
ZBX_START_PINGPOLLERS=20    # Coletores de ping
ZBX_START_DISCOVERERS=10    # Descoberta automática
ZBX_START_HTTPPOLLERS=5     # Coletores HTTP
ZBX_START_TIMERS=5          # Timers
ZBX_START_ESCALATORS=5      # Escalators
ZBX_START_TRAPPERS=20       # Trappers

# Configurações de database para grandes volumes (300GB+)
ZBX_DB_NAME=/var/lib/zabbix/zabbix_proxy.db
ZBX_HOUSEKEEPING_FREQUENCY=1
ZBX_MAX_HOUSEKEEPER_DELETE=100000

# Configurações de retenção para grandes volumes
ZBX_DB_MAX_SIZE_GB=280                    # Limite de 280GB (margem de segurança)
ZBX_HISTORY_STORAGE_DAYS=365             # Manter histórico por 1 ano
ZBX_TRENDS_STORAGE_DAYS=1825             # Manter trends por 5 anos

# Configurações de performance para grandes DBs
ZBX_DB_CACHE_SIZE=2048M                  # Cache do SQLite (2GB)
ZBX_DB_SYNC_FREQUENCY=300                # Sync a disco a cada 5min
ZBX_DB_CHECKPOINT_INTERVAL=3600          # Checkpoint SQLite a cada 1h

# Configurações de logs
ZBX_LOG_LEVEL=3           # 0=emergencias, 1=alerts, 2=critical, 3=erros, 4=warnings, 5=notices
ZBX_LOG_FILE_SIZE=50      # MB
ZBX_DEBUG_LEVEL=3

# Configurações de recursos do container
# Ajuste conforme o hardware disponível
CONTAINER_MEMORY_LIMIT=8G           # Limite máximo de memória
CONTAINER_MEMORY_RESERVATION=4G     # Memória garantida
CONTAINER_CPU_LIMIT=6.0             # Limite de CPU (cores)
CONTAINER_CPU_RESERVATION=3.0       # CPU garantida (cores)

# Configurações de rede
DNS_PRIMARY=8.8.8.8
DNS_SECONDARY=8.8.4.4

# Configurações específicas para equipamentos de rede
ZBX_SNMP_TRAP_TIMEOUT=10
ZBX_EXTERNAL_SCRIPTS_TIMEOUT=30
ZBX_FPING_LOCATION=/usr/bin/fping
ZBX_FPING6_LOCATION=/usr/bin/fping6

# Configurações de performance
ZBX_PROXY_CONFIG_FREQUENCY=10    # Frequência de sync config (segundos)
ZBX_PROXY_DATA_FREQUENCY=1       # Frequência de envio dados (segundos)
ZBX_STATS_ALLOWED_IP=127.0.0.1

# Configurações de segurança
ZBX_USER=zabbix
ZBX_GROUP=zabbix

# =============================================================================
# CONFIGURAÇÕES ESPECÍFICAS POR AMBIENTE
# =============================================================================

# Para ambientes com MENOS de 5k itens, use:
# ZBX_HISTORY_CACHE_SIZE=64M
# ZBX_START_POLLERS=20
# CONTAINER_MEMORY_LIMIT=4G

# Para ambientes com MAIS de 30k itens, use:
# ZBX_HISTORY_CACHE_SIZE=512M
# ZBX_TREND_CACHE_SIZE=256M
# ZBX_START_POLLERS=100
# CONTAINER_MEMORY_LIMIT=16G