version: '3.5'

# üöÄ CoreWise Zabbix Proxy + Scripts SSH
# Sistema de proxy para monitoramento distribu√≠do com coleta SSH
# Controle de acesso via firewall

services:
  zabbix-proxy:
    build:
      context: .
      dockerfile: Dockerfile.proxy
    image: corewise-zabbix-proxy:latest
    container_name: corewise-proxy
    environment:
      ZBX_HOSTNAME: corewise-proxy
      ZBX_SERVER_HOST: 45.161.89.183
      ZBX_SERVER_PORT: 10051
      ZBX_TIMEOUT: 30
      # Configura√ß√µes de compress√£o e reten√ß√£o
      ZBX_DATA_SENDER_COMPRESS: 1
      ZBX_PROXY_LOCAL_BUFFER: 720
      ZBX_PROXY_OFFLINE_BUFFER: 720
    ports:
      - "10051:10051/tcp"  # Apenas porta do Zabbix Proxy
    restart: always
    dns:
      - 8.8.8.8
      - 8.8.4.4
    networks:
      - zabbix-network
    deploy:
      resources:
        limits:
          memory: 4G
          cpus: '4.0'
        reservations:
          memory: 2G
          cpus: '2.0'
    labels:
      - "coolify.managed=true"

networks:
  zabbix-network:
    driver: bridge 